<header>
  <nav class="navbar">
    <div class="logo">
      <a href="index.html" id="header-site-title">Mon Site</a>
    </div>
    
    <ul class="nav-links" id="dynamic-menu">
      <li><a href="index.html">Accueil</a></li>
      <li><a href="publications.html">Publications</a></li>
      <li><a href="interventions.html">Interventions</a></li>
      <li><a href="cours.html">Cours</a></li>
    </ul>

    <div class="burger">
      <div class="line1"></div>
      <div class="line2"></div>
      <div class="line3"></div>
    </div>
  </nav>

  <script type="module">
    import { getSiteData } from './api.js';

    getSiteData().then(prof => {
      if (!prof) {
        console.warn("Utilisation du menu par défaut (aucun profil trouvé dans Supabase)");
        return;
      }

      // 1. Mise à jour du Titre du site (ex: "Mon Site")
      const siteTitle = document.getElementById('header-site-title');
      if (prof.site_title) {
        siteTitle.innerText = prof.site_title;
      }

      // 2. Gestion du Menu dynamique (depuis la colonne menu_config)
      const menuList = prof.menu_config; 
      const menuContainer = document.getElementById('dynamic-menu');

      if (menuList && menuList.length > 0) {
        // On génère proprement la liste des liens
        menuContainer.innerHTML = menuList.map(item => 
          `<li><a href="${item.url || '#'}">${item.titre || 'Lien'}</a></li>`
        ).join('');
      }
    }).catch(err => {
      console.error("Erreur lors de la récupération des données du Header:", err);
    });

    // 3. Logique du Burger Menu (UI)
    const burger = document.querySelector('.burger');
    const nav = document.querySelector('.nav-links');
    if(burger){
      burger.addEventListener('click', () => {
        nav.classList.toggle('nav-active');
        burger.classList.toggle('toggle');
      });
    }
  </script>
</header>
